


Как и массивы - неуправляемые строки это указатель на первый символ строки.\
Но со строками ещё сложнее - исходные библиотеки хранят строки в кодировке ANSI (и требуют 1 байт на символ)\
А управляемые строки - хранят символы в кодировке Unicode (2 байта на символ).

Кроме того, у неуправляемых строк принятно добавлять в конце строки символ `#0`.
Это позволяет вообще не хранить длину строки. Вместо этого конец строки считается там, где первый раз встретится символ `#0`.

Благо, для перевода между этими типами уже есть `Marshal.StringToHGlobalAnsi` и `Marshal.PtrToStringAnsi`.

`Marshal.StringToHGlobalAnsi` возвращает `IntPtr`, чтоб лишний раз не пачкать руки об указатели.\
`IntPtr` это целое число со знаком, занимающее в памяти тот же объём, что и указатель.\
Обычно `IntPtr` используется для дескрипторов. То есть указателей, разъименование которых не ожидается.

Но будьте осторожны - `Marshal.StringToHGlobalAnsi` выделяет неуправляемую память для хранения неуправляемого варианта строки.\
Когда неуправляемая память стала не нужна - её надо обязательно удалить с помощью `Marshal.FreeHGlobal`, иначе получите утечку памяти.


