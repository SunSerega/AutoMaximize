


Между командами для GPU (хранимыми в очередях типов `BufferCommandQueue` и `KernelCommandQueue`)
бывает надо вставить выполнение другой очереди или кода для CPU.

Это можно сделать, используя несколько `.NewQueue`:
```
var b: Buffer;
var q0: CommandQueueBase;
...
var q :=
  b.NewQueue.AddWriteValue(...) +
  q0 +
  HPQ(...) +
  b.NewQueue.AddWriteValue(...)
;
```
Однако можно сделать и красивее:
```
var b: Buffer;
var q0: CommandQueueBase;
...
var q := b.NewQueue
  .AddWriteValue(...)
  .AddQueue(q0)
  .AddProc(...)
  .AddWriteValue(...)
;
```
(вообще callback AddProc'а принимает исходный буфер/kernel параметром, что делает его более похожим на `.ThenConvert`, чем `HPQ`)

Эти методы не имеют незаменимых применений, но позволяют сделать код значительно читабельнее.

Кроме того, будьте осторожны, защита от дурака для такого случая - отсутствует:
```
var q := b.NewQueue;
q.AddQueue(q);
```
Все `.Add*` методы добавляют команды в существующую очередь, а не создают новую.
Поэтому очередь, созданная предыдущим кодом при попытке выполнения начнёт циклически запускать саму себя.


